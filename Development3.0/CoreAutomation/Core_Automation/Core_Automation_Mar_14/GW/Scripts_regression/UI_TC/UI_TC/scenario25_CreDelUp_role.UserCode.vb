'//////////////////////////////////////////////////////////////////////////////
'
' This file was automatically generated by RANOREX.
' http://www.ranorex.com
'
'//////////////////////////////////////////////////////////////////////////////

Imports System
Imports System.Collections.Generic
Imports System.Text
Imports System.Text.RegularExpressions
Imports System.Drawing
Imports System.Threading
Imports System.Windows.Forms

Imports Ranorex
Imports Ranorex.Core

Namespace UI_TC

	''' <summary>
	''' The Recording1 recording.
	''' </summary>
	Public Partial Class scenario25_CreDelUp_role




			Public Shared Sub validate_save_close()
			Dim tableRoleGrid As Table
			tableRoleGrid = "/dom[@domain~'^.*']/body/flexobject/container/container[@id='mainArea']/container/element/table[@id='roleGrid']"
			Dim count As String
			count=tableRoleGrid.Rows.Count
			Dim columnName As Column
			columnName = "/dom[@domain~'^.*']/body/flexobject/container/container[@id='mainArea']/container/element/table/column[@text='Name']"
			Dim cell_save As Cell
			Dim temp As String
			temp=0
			dim res as Integer=0
			Do Until temp = count
				report.Info("temp")
				Report.Info("count")
				report.Info(temp)
				Report.Info(count)
				Report.Info(res)
				cell_save="/dom[@domain~'^.*']/body/flexobject/container/container[@id='mainArea']/container/element/table/column[@text='Name']/cell[@rowindex='"+temp+"']"
				If StrComp(cell_save.Text,"testrole")=0 Then
					res=res+1
					Report.Info("matched")
				End If
				temp=temp+1
				Loop
		If res =1 Then
			Report.Success("passed")
		Else
			Report.Failure("failed")
		End If
		temp=0
		res=0
			Do Until temp = count
				Report.Info("-------------------")
				report.Info("temp")
				Report.Info("count")
				report.Info(temp)
				Report.Info(count)
				Report.Info(res)
				
				cell_save="/dom[@domain~'^.*']/body/flexobject/container/container[@id='mainArea']/container/element/table/column[@text='Name']/cell[@rowindex='"+temp+"']"
				If StrComp(cell_save.Text,"testrole1")=0 Then
					res=res+1
				End If
				temp=temp+1
			Loop
				If res =0 Then
			Report.Success("passed test1")
		Else
			Report.Failure("failed test1")
		End If
		End Sub

		Public Shared Sub UserCodeMethod1()
			'Your code here. Code inside this method will not be changed by the code generator.
			
		End Sub

		Public Shared Sub deleterole()
			Dim tableRoleGrid As Table
							tableRoleGrid = "/dom[@domain~'^.*']/body/flexobject/container/container[@id='mainArea']/container/element/table[@id='roleGrid']"

			Dim val As String =0
			Dim  Rowin As String=0
			Dim count As String=0
			dim temp as String=0
			
			Dim cellStr As Cell
			' "/dom[@domain~'^.*']/body/flexobject/container/container[@id='mainArea']/container/element/table/column[@text='Name']/cell[@columnindex='2' and @rowindex='"+temp+"']"
			cellStr ="/dom[@domain~'^.*']/body/flexobject/container/container[@id='mainArea']/container/element/table/column[@text='Name']/cell[@columnindex=1 and @rowindex='"+temp+"']"
			count=tableRoleGrid.Rows.Count
			do until temp=count
			If StrComp( cellStr.Text,"testrole")=0  Then
				val= val+1
				rowin=temp
				End If
				temp=temp+1
			Loop
			
			
						report.Info("before deleting role")
						report.Info(rowin)
						Dim row1 As row
						row1 = "/dom[@domain~'^.*']/body/flexobject/container/container[@id='mainArea']/container/element/table/row[@index='"+rowin+"']"
						row1.Click
						Dim buttonDelete As Ranorex.Button
						buttonDelete = "/dom[@domain~'^.*']/body/flexobject/container/container[@id='mainArea']/container/element/container/button[@id='deleteButton']"
						buttonDelete.Click
						Dim textConfirm_delete As Text
						textConfirm_delete = "/dom[@domain~'^.*']/body/flexobject/container[@caption='Confirm delete']/element[@type='UIComponent']/text[@caption='Confirm delete']"
						Dim containerConfirm_delete As Container
						containerConfirm_delete = "/dom[@domain~'^.*']/body/flexobject/container[@caption='Confirm delete']"
						Dim buttonNo As Ranorex.Button
						buttonNo = "/dom[@domain~'^.*']/body/flexobject/container[@caption='Confirm delete']/element[@type='AlertForm']/button[@text='No']"
'						Dim buttonYes As Ranorex.Button
'						buttonYes = "/dom[@domain~'^.*']/body/flexobject/container[@caption='Confirm delete']/element[@type='AlertForm']/button[@text='Yes']"
						Dim buttonYes As ranorex.Button
						buttonYes = "/dom[@domain~'^.*']/body/flexobject/container[@caption='Confirm delete']/element[@type='AlertForm']/button[@text='Yes']"
						buttonNo.Click
														'Dim count As String
							count=0
							count=tableRoleGrid.Rows.Count
							Dim columnName As Column
							columnName = "/dom[@domain~'^.*']/body/flexobject/container/container[@id='mainArea']/container/element/table/column[@text='Name']"
							Dim cell_save As Cell
						'	Dim temp As String
							temp=0
							dim res as Integer=0
							Do Until temp = count
'								report.Info("temp")
'								Report.Info("count")
'								report.Info(temp)
'								Report.Info(count)
'								Report.Info(res)
								cell_save="/dom[@domain~'^.*']/body/flexobject/container/container[@id='mainArea']/container/element/table/column[@text='Name']/cell[@rowindex='"+temp+"']"
								If StrComp(cell_save.Text,"testrole")=0 Then
									res=res+1
									Report.Info("matched")
								End If
								temp=temp+1
								Loop
						If res =1 Then
							Report.Success("passed test for delete -no")
						Else
							Report.Failure("passed test for delete -no")
				
						
						End If
						
		
					row1.Click
					report.Info("delete-yes")
					buttonDelete.Click
		
			Delay.Milliseconds(2750)
			Dim containerConfirm_delete1 As Container
			containerConfirm_delete1 = "/dom[@domain~'^.*']/body/flexobject/container[@caption='Confirm delete']"
			containerConfirm_delete1.Click
			Keyboard.Press(Keys.Tab, 15, Keyboard.DefaultKeyPressTime, 1, False)

			'Report.Info("Key 'Space' Press.")
			Keyboard.Press(Keys.Space, 57, Keyboard.DefaultKeyPressTime, 1, False)
			Delay.Milliseconds(2270)
		'	buttonYes.Click
					

		temp=0
		res=0
		
		try
			Do Until temp = count
'				Report.Info("-------------------")
'				report.Info("temp")
'				Report.Info("count")
'				report.Info(temp)
'				Report.Info(count)
'				Report.Info(res)
				cell_save="/dom[@domain~'^.*']/body/flexobject/container/container[@id='mainArea']/container/element/table/column[@text='Name']/cell[@rowindex='"+temp+"']"
				If StrComp(cell_save.Text,"testrole")=0 Then
					res=res+1
				End If
				temp=temp+1
			Loop
		Catch e As Exception
			report.Info("Last created role not found on screeen")
			End Try
			
				If res =0 Then
			Report.Success("passed test for delete -yes")
		Else
			Report.Failure("failed  test for delete -yes")
		End If
End Sub

		Shared Sub New()
			'Your recording specific initialization code goes here.
		End Sub
		

	End Class
End Namespace
